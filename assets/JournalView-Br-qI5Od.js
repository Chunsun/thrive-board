import{k as L,d as H,h as u,l as S,w as Q,c as n,a as t,t as o,u as R,F as _,r as w,m as V,p as J,v as z,q as X,j as C,f as B,o as r}from"./index-KxkJJsT9.js";const Y=L("mood",{state:()=>({selectedMood:""}),actions:{setMood(c){this.selectedMood=c}}}),Z=L("journal",{state:()=>({entries:[]}),actions:{addEntry(c){this.entries.push(c),localStorage.setItem("journalEntries",JSON.stringify(this.entries))},loadEntries(){const c=localStorage.getItem("journalEntries");c&&(this.entries=JSON.parse(c))}}}),ee={class:"max-w-xl mx-auto space-y-6 p-2"},te={class:"bg-white rounded-2xl shadow p-4"},se={class:"flex justify-between text-sm text-gray-500 mb-2"},le={class:"mb-3"},oe={class:"flex gap-2"},ae=["onClick"],ne={class:"mb-3"},re={class:"italic text-gray-700 mb-1"},ie={class:"mb-3"},de={class:"mb-3"},ue={class:"flex flex-wrap gap-2"},ce=["onClick","disabled"],ve={key:1,class:"flex items-center gap-1"},be={class:"mb-3 flex items-center gap-2 text-sm text-gray-500"},me={class:"flex flex-col items-center mt-4"},fe=["disabled"],pe={class:"bg-white rounded-2xl shadow p-4"},xe={key:0,class:"text-gray-400 text-sm"},ge=["onClick"],ye={class:"text-base"},he={class:"text-xl"},_e={class:"font-semibold text-gray-700"},we={class:"flex gap-1"},ke={key:0,class:"text-xs text-gray-400 ml-2"},Se={key:0,class:"ml-8 text-gray-700 text-sm border-l-2 border-blue-100 pl-4 py-1"},Ee=H({__name:"JournalView",setup(c){const E=Y(),d=Z(),M=new Date,A=M.toLocaleDateString("zh-TW",{weekday:"long",month:"long",day:"numeric"}),T=M.toISOString().slice(0,10),D=[{label:"😃",value:"Great"},{label:"🙂",value:"Okay"},{label:"😐",value:"Meh"},{label:"🙁",value:"Down"},{label:"😢",value:"Sad"}],b=u(E.selectedMood||""),I=["今天最具挑戰的是什麼？","你現在最感激的是什麼？","今天你學到了什麼？","明天你想改進什麼？","今天誰對你產生了正面影響？"],g=u(0),F=S(()=>I[g.value]);function K(){let l=g.value;for(;l===g.value;)l=Math.floor(Math.random()*I.length);g.value=l}const v=u(""),U=[{icon:"🧠",label:"成長"},{icon:"🏋",label:"健康"},{icon:"❤️",label:"愛情"},{icon:"💼",label:"工作"},{icon:"💰",label:"財務"},{icon:"🧘",label:"平靜"}],a=u([]),y=u(!1),m=u(""),j=()=>{m.value&&!a.value.includes(m.value)&&(a.value.push(m.value),m.value="",y.value=!1)},W=l=>{a.value.includes(l)?a.value=a.value.filter(s=>s!==l):a.value.length<3&&a.value.push(l)},N=u(null),f=u(0),p=u(null);function q(){p.value||(N.value=Date.now(),p.value=setInterval(()=>{f.value=Math.floor((Date.now()-(N.value||Date.now()))/1e3)},1e3))}function O(){p.value&&clearInterval(p.value),p.value=null}function $(l){const s=Math.floor(l/60),e=l%60;return`${s.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}Q(v,(l,s)=>{l&&!s&&q(),l||(O(),f.value=0)});const G=()=>{!b.value||!v.value.trim()||(d.addEntry({mood:b.value,text:v.value,date:T,tags:[...a.value],seconds:f.value}),v.value="",a.value=[],E.setMood(b.value),O(),f.value=0,typeof d.loadEntries=="function"&&d.loadEntries())};if(typeof d.loadEntries=="function"&&d.loadEntries(),!d.entries||d.entries.length===0){const l=localStorage.getItem("journalEntries");l&&(d.entries=JSON.parse(l))}const k=S(()=>d.entries),h=u(null),P=S(()=>{const l=(d.entries||[]).map(i=>i.date).sort().reverse();let s=0;const e=new Date(T);for(let i=0;i<l.length;i++)if(l[i]===e.toISOString().slice(0,10))s++,e.setDate(e.getDate()-1);else if(i===0)break;return s});return(l,s)=>(r(),n("div",ee,[t("div",te,[s[10]||(s[10]=t("div",{class:"flex items-center gap-2 text-lg font-bold mb-2"},"📓 日誌",-1)),t("div",se,[t("span",null,"🗓️ 今天："+o(R(A)),1),t("span",null,"🔥 連續天數："+o(P.value)+" 天",1)]),t("div",le,[s[4]||(s[4]=t("div",{class:"font-semibold mb-1"},"😄 今天的心情如何？",-1)),t("div",oe,[(r(),n(_,null,w(D,e=>t("button",{key:e.value,onClick:i=>b.value=e.value,class:B(["w-10 h-10 rounded-full flex items-center justify-center text-2xl border transition",b.value===e.value?"bg-blue-100 border-blue-500 scale-110":"bg-gray-50 border-gray-200 hover:bg-blue-50"])},o(e.label),11,ae)),64))])]),t("div",ne,[t("div",{class:"font-semibold mb-1 flex items-center gap-2"},[s[5]||(s[5]=V(" 💬 今日提問 ")),t("button",{onClick:K,class:"ml-2 px-2 py-1 rounded bg-gray-100 text-xs hover:bg-blue-100"}," 🔄 換一題 ")]),t("div",re,"「"+o(F.value)+"」",1)]),t("div",ie,[s[6]||(s[6]=t("div",{class:"font-semibold mb-1"},"📝 你的反思",-1)),J(t("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e),class:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 text-base resize-none",rows:"3",maxlength:"240",placeholder:"分享你的想法..."},null,512),[[z,v.value]])]),t("div",de,[s[8]||(s[8]=t("div",{class:"font-semibold mb-1"},"🏷️ 標籤（最多選 3 項）：",-1)),t("div",ue,[(r(),n(_,null,w(U,e=>t("button",{key:e.icon+e.label,onClick:i=>W(e.label),class:B(["px-3 py-1 rounded-full border text-sm flex items-center gap-1 transition",a.value.includes(e.label)?"bg-blue-100 border-blue-400 text-blue-700 font-semibold":"bg-gray-50 border-gray-200 text-gray-500 hover:bg-blue-50"]),disabled:a.value.length>=3&&!a.value.includes(e.label)},[t("span",null,o(e.icon),1),s[7]||(s[7]=V()),t("span",null,o(e.label),1)],10,ce)),64)),y.value?(r(),n("div",ve,[J(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>m.value=e),class:"px-2 py-1 border rounded text-sm w-24",placeholder:"自訂標籤",onKeyup:X(j,["enter"])},null,544),[[z,m.value]]),t("button",{onClick:j,class:"text-blue-600 text-sm font-semibold"},"新增"),t("button",{onClick:s[3]||(s[3]=e=>y.value=!1),class:"text-gray-400 text-sm"},"✕")])):(r(),n("button",{key:0,onClick:s[1]||(s[1]=e=>y.value=!0),class:"px-3 py-1 rounded-full border border-dashed border-gray-300 text-gray-400 text-sm hover:bg-gray-100"}," ➕ 新增標籤 "))])]),t("div",be,[t("span",null,"⏱️ 反思時間："+o($(f.value)),1)]),t("div",me,[t("button",{onClick:G,disabled:!b.value||!v.value.trim(),class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg shadow"}," ✅ 提交日誌 ",8,fe),s[9]||(s[9]=t("div",{class:"text-xs text-gray-400 mt-1"},"你正在養成強大的習慣！",-1))])]),t("div",pe,[s[11]||(s[11]=t("div",{class:"flex items-center gap-2 text-lg font-bold mb-2"},"🕰️ 最近紀錄",-1)),k.value&&k.value.length===0?(r(),n("div",xe," 尚無過去紀錄。 ")):C("",!0),(r(!0),n(_,null,w(k.value||[],e=>{var i;return r(),n("div",{key:e.date+e.mood+e.text,class:"mb-2"},[t("div",{class:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 rounded p-2",onClick:x=>h.value===e.date?h.value=null:h.value=e.date},[t("span",ye,"• "+o(new Date(e.date).toLocaleString("zh-TW",{month:"short",day:"numeric"}))+" –",1),t("span",he,o(((i=D.find(x=>x.value===e.mood))==null?void 0:i.label)||"📝"),1),t("span",_e,o(e.mood),1),t("span",we,[(r(!0),n(_,null,w(e&&"tags"in e&&Array.isArray(e.tags)?e.tags:[],x=>(r(),n("span",{key:x,class:"px-2 py-0.5 rounded-full bg-gray-100 text-xs text-gray-500 border border-gray-200"},o(x),1))),128))]),"seconds"in e&&typeof e.seconds=="number"&&e.seconds>0?(r(),n("span",ke,"（"+o($(Number(e.seconds)))+"）",1)):C("",!0)],8,ge),h.value===e.date?(r(),n("div",Se,o(e.text),1)):C("",!0)])}),128)),s[12]||(s[12]=t("div",{class:"flex justify-end mt-2"},[t("button",{class:"text-blue-600 text-sm font-semibold flex items-center gap-1 hover:underline"}," 📂 查看所有日誌 → ")],-1))])]))}});export{Ee as default};
